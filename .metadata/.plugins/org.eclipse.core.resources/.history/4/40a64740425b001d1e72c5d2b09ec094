
/* Drop Tables */

DROP TABLE REPLY CASCADE CONSTRAINTS;
DROP TABLE T_VOTE CASCADE CONSTRAINTS;
DROP TABLE T_SURVEY CASCADE CONSTRAINTS;
DROP TABLE MADANG.T_MEMBER CASCADE CONSTRAINTS;




/* Create Sequences */

CREATE SEQUENCE SEQ_T_SURVEY_SURVEY_NO INCREMENT BY 1 START WITH 1;



/* Create Tables */

CREATE TABLE REPLY
(

);


CREATE TABLE T_SURVEY
(
	SURVEY_NO number NOT NULL,
	TITLE varchar2(100),
	ONE varchar2(200),
	ONE_CNT number,
	TWO varchar2(200),
	TWO_CNT number,
	START_DATE date,
	REG_DATE date,
	MOD_DATE date,
	PRIMARY KEY (SURVEY_NO)
);


CREATE TABLE T_VOTE
(
	SURVEY_NO number NOT NULL,
	ID varchar2(20 char) NOT NULL,
	ONE_TWO varchar2(200),
	VOTE_DATE date
);


CREATE TABLE MADANG.T_MEMBER
(
	ID varchar2(20 char) NOT NULL,
	PW varchar2(20 char) NOT NULL,
	NAME varchar2(20 char) NOT NULL,
	EMAIL varchar2(50 char),
	PHOTO varchar2(100 char),
	GENDER char(1 char),
	JOINDATE date DEFAULT SYSDATE
	,
	CONSTRAINT SYS_C007025 PRIMARY KEY (ID)
);



/* Create Foreign Keys */

ALTER TABLE T_VOTE
	ADD FOREIGN KEY (SURVEY_NO)
	REFERENCES T_SURVEY (SURVEY_NO)
;


ALTER TABLE T_VOTE
	ADD FOREIGN KEY (ID)
	REFERENCES MADANG.T_MEMBER (ID)
;



/* Create Triggers */

CREATE OR REPLACE TRIGGER TRI_T_SURVEY_SURVEY_NO BEFORE INSERT ON T_SURVEY
FOR EACH ROW
BEGIN
	SELECT SEQ_T_SURVEY_SURVEY_NO.nextval
	INTO :new.SURVEY_NO
	FROM dual;
END;

/




